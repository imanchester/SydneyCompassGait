function y = mappingdot(I_c, l, l_c, m, mH, q1, q2) 
%----------------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------------
%----- System identification of an asymmetric compass gait walker from experimental data ------
%----------------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------------
% 
% This script is adapted from Dr. Justin Z. Tang's script and it represents the mapping between 
% pre and post impacts velocities.
% 
% For more information, please refer to: 
% """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
% ""                           The Sydney Compass Gait Robot:                                ""
% ""        Design and Modeling of an Open Platform for Dynamic Walking Research             ""
% """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
% 
% 
% Date created: 02/08/2017            Date modified: 14/09/2017
% Authors: A. Mounir Boudali and Justin Z. Tang 
% Note: *this mapping can be simplified. See line 33.
%----------------------------------------------------------------------------------------------
%----------------------------------------------------------------------------------------------
deltaqDot = [( I_c^2 ...
            + l_c^4*m^2 ...
            - 2*l*l_c^3*m^2 ...
            + 2*l^2*l_c^2*m^2 ...
            + 2*I_c*l^2*m ...
            + I_c*l^2*mH ...
            + 2*I_c*l_c^2*m ...
            - 2*l^2*l_c^2*m^2*sin(q2)^2 ...
            - 2*I_c*l^2*m*cos(q2)^2 ... % *lines 33 and 34 can be simplified by "- 2*I_c*l^2*m"
            - 2*I_c*l^2*m*sin(q2)^2 ...
            - I_c*l^2*mH*cos(q2)^2 ...
            - I_c*l^2*mH*sin(q2)^2 ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)^2 ...
            + 2*l^2*l_c^2*m^2*sin(q1 - q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q2)^2 + 2*l*l_c^3*m^2*sin(q2)^2 ...
            - l*l_c^3*m^2*cos(q1 - q2)^2 - 2*l^3*l_c*m^2*cos(q1 - q2)^2 + l^2*l_c^2*m*mH ...
            - l*l_c^3*m^2*sin(q1 - q2)^2 - 2*l^3*l_c*m^2*sin(q1 - q2)^2 - 2*I_c*l*l_c*m ...
            - l^2*l_c^2*m^2*cos(q1)^2 - 2*l^2*l_c^2*m^2*cos(q2)^2 - l^2*l_c^2*m*mH*cos(q2)^2 ...
            - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 - l^2*l_c^2*m*mH*sin(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) + 2*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q2)^2 + 2*I_c*l*l_c*m*sin(q2)^2 - l*l_c^3*m^2*cos(q1 - q2)*cos(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l*l_c^3*m^2*sin(q1 - q2)*sin(q2) - I_c*l*l_c*m*sin(q1 - q2)^2 ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 - 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)^2 - l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) ...
            + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2 + l^2*l_c^2*m^2*cos(q1 - q2)*cos(q1)*cos(q2) ...
            - l^2*l_c^2*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) ...
            + I_c*l*l_c*m*sin(q1 - q2)*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 ...
            - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 - 4*l^4*m^2*sin(q1 - q2)^2 ...
            - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH - 2*I_c*l_c^2*m ...
            + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 ...
            + 2*I_c*l^2*m*sin(q2)^2 + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 ...
            - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 ...
            - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 ...
            - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 ...
            - 2*l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 - l^2*l_c^2*m*mH ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2)...
            ,...
            -(4*l^4*m^2*sin(q1 - q2)*sin(q2)^3 ...
            - l^4*mH^2*cos(q1 - q2)^2 - 4*l^4*m^2*sin(q1 - q2)^2 - l^4*mH^2*sin(q1 - q2)^2 ...
            - 4*l^2*l_c^2*m^2*cos(q1 - q2)^2 - 4*l^4*m^2*cos(q1 - q2)*cos(q2)^3 ...
            - l^4*mH^2*cos(q1 - q2)*cos(q2)^3 - 4*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 ...
            - I_c*l^2*mH*cos(q1 - q2)^2 - 4*l^4*m^2*cos(q1 - q2)^2 + l^4*mH^2*sin(q1 - q2)*sin(q2)^3 ...
            - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 ...
            - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 + l*l_c^3*m^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 + l*l_c^3*m^2*cos(q1 - q2)^2 ...
            + 6*l^3*l_c*m^2*cos(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)*cos(q2) + l^4*mH^2*cos(q1 - q2)*cos(q2) ...
            + l*l_c^3*m^2*sin(q1 - q2)^2 + 6*l^3*l_c*m^2*sin(q1 - q2)^2 - 4*l^4*m^2*sin(q1 - q2)*sin(q2) ...
            - l^4*mH^2*sin(q1 - q2)*sin(q2) - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) ...
            - 4*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 4*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^4*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 - l^4*mH^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            + 2*l^2*l_c^2*m^2*sin(q1 - q2)*sin(q2)^3 - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) ...
            - 4*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 + I_c*l*l_c*m*cos(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) + l^4*mH^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            + I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - 2*l*l_c^3*m^2*cos(q1 - q2)*cos(q2) ...
            - 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2) - 4*l^4*m*mH*cos(q1 - q2)*cos(q2)^3 ...
            - l^2*l_c^2*m*mH*sin(q1 - q2)^2 + I_c*l*l_c*m*cos(q1 - q2)^2 + 2*l*l_c^3*m^2*sin(q1 - q2)*sin(q2) ...
            + 6*l^3*l_c*m^2*sin(q1 - q2)*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)*sin(q2)^3 + I_c*l*l_c*m*sin(q1 - q2)^2 ...
            + 4*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) ...
            + 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2)^3 - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l^2*m*cos(q1 - q2)*cos(q2) + I_c*l^2*mH*cos(q1 - q2)*cos(q2) ...
            - 4*l^2*l_c^2*m^2*sin(q1 - q2)*sin(q2) - 6*l^3*l_c*m^2*sin(q1 - q2)*sin(q2)^3 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            - l^2*l_c^2*m^2*cos(q1)*cos(q2)^2 + 3*l^3*l_c*m*mH*cos(q1 - q2)^2 - 2*I_c*l^2*m*sin(q1 - q2)*sin(q2) ...
            - I_c*l^2*mH*sin(q1 - q2)*sin(q2) - l^2*l_c^2*m^2*cos(q1)*sin(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)*cos(q2) ...
            + 3*l^3*l_c*m*mH*sin(q1 - q2)^2 - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2)^3 + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) ...
            - 4*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^4*m*mH*sin(q1 - q2)*sin(q2) ...
            - 2*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)*cos(q1)*cos(q2) - 2*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            - 2*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - 4*l^4*m*mH*cos(q1 - q2)*cos(q2)*sin(q2)^2 - 2*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2) + 3*l^3*l_c*m*mH*sin(q1 - q2)*sin(q2) ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q1)*cos(q2) + 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)*cos(q1)*sin(q2) - 6*l^3*l_c*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            + l^2*l_c^2*m*mH*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            + 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2)^3 - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) ...
            + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) - 2*I_c*l*l_c*m*cos(q1 - q2)*cos(q2) ...
            - l^2*l_c^2*m*mH*sin(q1 - q2)*sin(q2) - 3*l^3*l_c*m*mH*sin(q1 - q2)*sin(q2)^3 ...
            + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) - 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)*sin(q2) + 2*l^2*l_c^2*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - l^3*l_c*m*mH*cos(q1 - q2)*cos(q1)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)*cos(q1)*sin(q2) ...
            + 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2)*sin(q2)^2 - 3*l^3*l_c*m*mH*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 ...
            - 4*l^4*m^2*sin(q1 - q2)^2 - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH ...
            - 2*I_c*l_c^2*m + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 ...
            + 2*I_c*l^2*m*sin(q2)^2 + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 ...
            - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 ...
            - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 ...
            - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 ...
            - 2*l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 - l^2*l_c^2*m*mH ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2)
            
            (I_c^2 + l_c^4*m^2 - 2*l*l_c^3*m^2 + 2*l^2*l_c^2*m^2 + 2*I_c*l^2*m + I_c*l^2*mH + 2*I_c*l_c^2*m ...
            - 2*l^2*l_c^2*m^2*sin(q2)^2 - 2*I_c*l^2*m - I_c*l^2*mH + 2*l^2*l_c^2*m^2 + 2*l*l_c^3*m^2 ...
            - l*l_c^3*m^2*cos(q1 - q2)^2 - 2*l^3*l_c*m^2 + l^2*l_c^2*m*mH - l*l_c^3*m^2*sin(q1 - q2)^2 ...
            - 2*I_c*l*l_c*m - l^2*l_c^2*m^2*cos(q1)^2 - 2*l^2*l_c^2*m^2*cos(q2)^2 - l^2*l_c^2*m*mH*cos(q2)^2 ...
            - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 - l^2*l_c^2*m*mH*sin(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) + 2*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q2)^2 + 2*I_c*l*l_c*m*sin(q2)^2 - l*l_c^3*m^2*cos(q1 - q2)*cos(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l*l_c^3*m^2*sin(q1 - q2)*sin(q2) - I_c*l*l_c*m*sin(q1 - q2)^2 ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 - 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)^2 - l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) ...
            + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2 + l^2*l_c^2*m^2*cos(q1 - q2)*cos(q1)*cos(q2) ...
            - l^2*l_c^2*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) ...
            + I_c*l*l_c*m*sin(q1 - q2)*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 ...
            - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 - 4*l^4*m^2*sin(q1 - q2)^2 ...
            - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH - 2*I_c*l_c^2*m ...
            + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 + 2*I_c*l^2*m*sin(q2)^2 ...
            + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 ...
            - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 - 2*I_c*l^2*m*sin(q1 - q2)^2 ...
            - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 - 4*l^4*m*mH*sin(q1 - q2)^2 ...
            + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*cos(q2)^2 ...
            + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 - l^2*l_c^2*m*mH ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2) - (l*l_c^3*m^2*sin(q1 - q2)*sin(q2) ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) - l*l_c^3*m^2*cos(q1 - q2)*cos(q2) ...
            - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) ...
            + I_c*l*l_c*m*sin(q1 - q2)*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 ...
            - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 - 4*l^4*m^2*sin(q1 - q2)^2 ...
            - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH - 2*I_c*l_c^2*m ...
            + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 ...
            + 2*I_c*l^2*m*sin(q2)^2 + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 ...
            - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 ...
            - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 ...
            - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 ...
            - 2*l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 - l^2*l_c^2*m*mH ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2)...
            ,...
            (2*l*l_c^3*m^2 - l_c^4*m^2 ...
            - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 - 4*l^4*m^2*sin(q1 - q2)^2 ...
            - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH - 2*I_c*l_c^2*m ...
            + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 ...
            + 2*I_c*l^2*m*sin(q2)^2 + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 ...
            - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 ...
            - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 ...
            - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 - l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - l*l_c^3*m^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 ...
            - l^2*l_c^2*m*mH + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) - 6*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            - 6*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 + l^2*l_c^2*m*mH*sin(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) - 6*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            - I_c*l*l_c*m*cos(q2)^2 - I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 ...
            - l*l_c^3*m^2*cos(q1 - q2)*cos(q2) - l^2*l_c^2*m*mH*sin(q1 - q2)^2 + 2*I_c*l*l_c*m*cos(q1 - q2)^2 ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 + l*l_c^3*m^2*sin(q1 - q2)*sin(q2) ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 2*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) ...
            - 6*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 3*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) - 2*l^3*l_c*m^2*cos(q1 - q2)*cos(q1)*cos(q2) ...
            - 3*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 - 3*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) - 3*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + l^2*l_c^2*m^2*cos(q1 - q2)*cos(q1)*cos(q2) ...
            - l^2*l_c^2*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - I_c*l*l_c*m*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) ...
            + I_c*l*l_c*m*sin(q1 - q2)*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)*cos(q1)*cos(q2) ...
            + l^3*l_c*m*mH*sin(q1 - q2)*cos(q1)*sin(q2) - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 ...
            - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 - 4*l^4*m^2*sin(q1 - q2)^2 ...
            - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m - I_c*l^2*mH - 2*I_c*l_c^2*m ...
            + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 + I_c*l^2*mH*cos(q2)^2 + 2*I_c*l^2*m*sin(q2)^2 ...
            + I_c*l^2*mH*sin(q2)^2 - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 ...
            - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 - 2*I_c*l^2*m*sin(q1 - q2)^2 ...
            - I_c*l^2*mH*sin(q1 - q2)^2 - 4*l^4*m*mH*cos(q1 - q2)^2 - 4*l^4*m*mH*sin(q1 - q2)^2 ...
            + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*cos(q2)^2 ...
            + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 ...
            - 2*l*l_c^3*m^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 - l^2*l_c^2*m*mH ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 ...
            + 2*I_c*l*l_c*m*cos(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)^2 + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            - 4*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2) - (4*l^4*m^2*sin(q1 - q2)*sin(q2)^3 ...
            - l^4*mH^2*cos(q1 - q2)^2 - 4*l^4*m^2*sin(q1 - q2)^2 - l^4*mH^2*sin(q1 - q2)^2 ...
            - 4*l^2*l_c^2*m^2*cos(q1 - q2)^2 - 4*l^4*m^2*cos(q1 - q2)*cos(q2)^3 ...
            - l^4*mH^2*cos(q1 - q2)*cos(q2)^3 - 4*l^2*l_c^2*m^2*sin(q1 - q2)^2 ...
            - 2*I_c*l^2*m*cos(q1 - q2)^2 - I_c*l^2*mH*cos(q1 - q2)^2 - 4*l^4*m^2*cos(q1 - q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)*sin(q2)^3 - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 ...
            - 4*l^4*m*mH*cos(q1 - q2)^2 - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 + l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 + l*l_c^3*m^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 + l*l_c^3*m^2*cos(q1 - q2)^2 + 6*l^3*l_c*m^2*cos(q1 - q2)^2 ...
            + 4*l^4*m^2*cos(q1 - q2)*cos(q2) + l^4*mH^2*cos(q1 - q2)*cos(q2) + l*l_c^3*m^2*sin(q1 - q2)^2 ...
            + 6*l^3*l_c*m^2*sin(q1 - q2)^2 - 4*l^4*m^2*sin(q1 - q2)*sin(q2) - l^4*mH^2*sin(q1 - q2)*sin(q2) ...
            - l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q1) - 4*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            - 4*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 - 4*l^4*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            - l^4*mH^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 + 2*l^2*l_c^2*m^2*sin(q1 - q2)*sin(q2)^3 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)^3*sin(q2) - 4*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + I_c*l*l_c*m*cos(q2)^2 + 4*l^4*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            + l^4*mH^2*sin(q1 - q2)*cos(q2)^2*sin(q2) + I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH*cos(q1 - q2)^2 ...
            - 2*l*l_c^3*m^2*cos(q1 - q2)*cos(q2) - 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2) ...
            - 4*l^4*m*mH*cos(q1 - q2)*cos(q2)^3 - l^2*l_c^2*m*mH*sin(q1 - q2)^2 + I_c*l*l_c*m*cos(q1 - q2)^2 ...
            + 2*l*l_c^3*m^2*sin(q1 - q2)*sin(q2) + 6*l^3*l_c*m^2*sin(q1 - q2)*sin(q2) ...
            + 4*l^4*m*mH*sin(q1 - q2)*sin(q2)^3 + I_c*l*l_c*m*sin(q1 - q2)^2 ...
            + 4*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2) + 2*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q1) ...
            + 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2)^3 - 2*l^3*l_c*m^2*cos(q1 - q2)^3*cos(q2) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 2*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q1) ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            + 2*I_c*l^2*m*cos(q1 - q2)*cos(q2) + I_c*l^2*mH*cos(q1 - q2)*cos(q2) ...
            - 4*l^2*l_c^2*m^2*sin(q1 - q2)*sin(q2) - 6*l^3*l_c*m^2*sin(q1 - q2)*sin(q2)^3 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)^3*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            - l^2*l_c^2*m^2*cos(q1)*cos(q2)^2 + 3*l^3*l_c*m*mH*cos(q1 - q2)^2 - 2*I_c*l^2*m*sin(q1 - q2)*sin(q2) ...
            - I_c*l^2*mH*sin(q1 - q2)*sin(q2) - l^2*l_c^2*m^2*cos(q1)*sin(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)*cos(q2) ...
            + 3*l^3*l_c*m*mH*sin(q1 - q2)^2 - l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q1) ...
            - 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2)^3 + 2*l^2*l_c^2*m^2*cos(q1 - q2)^3*cos(q2) ...
            - 4*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^4*m*mH*sin(q1 - q2)*sin(q2) ...
            - 2*l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q2)^2 + 2*l^2*l_c^2*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)*cos(q1)*cos(q2) - 2*l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q2)^2 ...
            - 2*l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q2)^2 - 2*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) ...
            - 4*l^4*m*mH*cos(q1 - q2)*cos(q2)*sin(q2)^2 - 2*l^3*l_c*m*mH*sin(q1 - q2)^2*sin(q2)^2 ...
            + 2*l^3*l_c*m^2*sin(q1 - q2)*cos(q1)*sin(q2) + 4*l^4*m*mH*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2) + 3*l^3*l_c*m*mH*sin(q1 - q2)*sin(q2) ...
            + 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q1)*cos(q2) + 6*l^3*l_c*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            - 2*l^2*l_c^2*m^2*sin(q1 - q2)*cos(q1)*sin(q2) - 6*l^3*l_c*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            + l^2*l_c^2*m*mH*cos(q1 - q2)*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*cos(q1) ...
            + 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2)^3 - l^3*l_c*m*mH*cos(q1 - q2)^3*cos(q2) ...
            - 2*l^3*l_c*m^2*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)^2*cos(q1) ...
            + 2*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2) - 2*I_c*l*l_c*m*cos(q1 - q2)*cos(q2) ...
            - l^2*l_c^2*m*mH*sin(q1 - q2)*sin(q2) - 3*l^3*l_c*m*mH*sin(q1 - q2)*sin(q2)^3 ...
            + l^3*l_c*m*mH*sin(q1 - q2)^3*sin(q2) - 2*l^2*l_c^2*m^2*cos(q1 - q2)*cos(q2)*sin(q2)^2 ...
            + 2*I_c*l*l_c*m*sin(q1 - q2)*sin(q2) + 2*l^2*l_c^2*m^2*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - l^3*l_c*m*mH*cos(q1 - q2)*cos(q1)*cos(q2) + l^3*l_c*m*mH*sin(q1 - q2)*cos(q1)*sin(q2) ...
            + 3*l^3*l_c*m*mH*cos(q1 - q2)*cos(q2)*sin(q2)^2 - 3*l^3*l_c*m*mH*sin(q1 - q2)*cos(q2)^2*sin(q2) ...
            - l^3*l_c*m*mH*cos(q1 - q2)*sin(q1 - q2)^2*cos(q2) + l^3*l_c*m*mH*cos(q1 - q2)^2*sin(q1 - q2)*sin(q2)...
            )/(...
            2*l*l_c^3*m^2 - l_c^4*m^2 - 4*l^4*m^2*cos(q1 - q2)^2 - l^4*mH^2*cos(q1 - q2)^2 - I_c^2 ...
            - 4*l^4*m^2*sin(q1 - q2)^2 - l^4*mH^2*sin(q1 - q2)^2 - 2*l^2*l_c^2*m^2 - 2*I_c*l^2*m ...
            - I_c*l^2*mH - 2*I_c*l_c^2*m + 2*l^2*l_c^2*m^2*sin(q2)^2 + 2*I_c*l^2*m*cos(q2)^2 ...
            + I_c*l^2*mH*cos(q2)^2 + 2*I_c*l^2*m*sin(q2)^2 + I_c*l^2*mH*sin(q2)^2 ...
            - 6*l^2*l_c^2*m^2*cos(q1 - q2)^2 - 6*l^2*l_c^2*m^2*sin(q1 - q2)^2 - 2*I_c*l^2*m*cos(q1 - q2)^2 ...
            - I_c*l^2*mH*cos(q1 - q2)^2 - 2*I_c*l^2*m*sin(q1 - q2)^2 - I_c*l^2*mH*sin(q1 - q2)^2 ...
            - 4*l^4*m*mH*cos(q1 - q2)^2 - 4*l^4*m*mH*sin(q1 - q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*cos(q2)^2 ...
            + l^4*mH^2*cos(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*cos(q2)^2 + 4*l^4*m^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + 4*l^4*m^2*sin(q1 - q2)^2*cos(q2)^2 + l^4*mH^2*cos(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*cos(q2)^2 - 2*l*l_c^3*m^2*sin(q2)^2 + 4*l^4*m^2*sin(q1 - q2)^2*sin(q2)^2 ...
            + l^4*mH^2*sin(q1 - q2)^2*sin(q2)^2 + 2*l*l_c^3*m^2*cos(q1 - q2)^2 + 8*l^3*l_c*m^2*cos(q1 - q2)^2 ...
            - l^2*l_c^2*m*mH + 2*l*l_c^3*m^2*sin(q1 - q2)^2 + 8*l^3*l_c*m^2*sin(q1 - q2)^2 + 2*I_c*l*l_c*m ...
            + l^2*l_c^2*m^2*cos(q1)^2 + 2*l^2*l_c^2*m^2*cos(q2)^2 + l^2*l_c^2*m*mH*cos(q2)^2 ...
            - 8*l^3*l_c*m^2*cos(q1 - q2)^2*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + l^2*l_c^2*m*mH*sin(q2)^2 - 8*l^3*l_c*m^2*sin(q1 - q2)^2*sin(q2)^2 - 2*I_c*l*l_c*m*cos(q2)^2 ...
            - 2*I_c*l*l_c*m*sin(q2)^2 - l^2*l_c^2*m*mH + 2*I_c*l*l_c*m*cos(q1 - q2)^2 ...
            + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*cos(q2)^2 + 2*I_c*l*l_c*m*sin(q1 - q2)^2 ...
            + 4*l^2*l_c^2*m^2*cos(q1 - q2)^2*sin(q2)^2 + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*cos(q2)^2 ...
            + 4*l^2*l_c^2*m^2*sin(q1 - q2)^2*sin(q2)^2 + 4*l^4*m*mH*cos(q1 - q2)^2*cos(q2)^2 ...
            + 4*l^4*m*mH*cos(q1 - q2)^2*sin(q2)^2 + 4*l^4*m*mH*sin(q1 - q2)^2*cos(q2)^2 ...
            + 4*l^4*m*mH*sin(q1 - q2)^2*sin(q2)^2 + 4*l^3*l_c*m*mH*cos(q1 - q2)^2 ...
            + 4*l^3*l_c*m*mH*sin(q1 - q2)^2 - 8*l^3*l_c*m^2*cos(q1 - q2)^2*cos(q2)^2 - 4*l^3*l_c*m*mH)];
                


y = deltaqDot;

